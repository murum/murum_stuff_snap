function showPreview(e){var a=160/e.w,i=160/e.h,s=$("img#image-cropper").height(),r=$("img#image-cropper").width();$("img#image-preview").css({width:Math.round(i*r)+"px",height:Math.round(i*s)+"px",marginLeft:"-"+Math.round(a*e.x)+"px",marginTop:"-"+Math.round(i*e.y)+"px"}),$('input[name="x"]',"form.image-form-update").attr("value",e.x),$('input[name="y"]',"form.image-form-update").val(e.y),$('input[name="w"]',"form.image-form-update").val(e.w),$('input[name="h"]',"form.image-form-update").val(e.h),$('input[name="image-width"]',"form.image-form-update").val(r),$('input[name="image-height"]',"form.image-form-update").val(s)}function preloader(){if(document.images){var e=new Image;e.src="/images/logo-animate.gif"}}function progressHandlingFunction(e){e.lengthComputable&&$("progress").attr({value:e.loaded,max:e.total})}$(function(){preloader(),$(".navbar-brand img").hover(function(){$(this).attr("src","/images/logo-animate.gif")},function(){$(this).attr("src","/images/logo.png")}),$(".selectpicker").selectpicker();var e=$("input#image").fileinput({showPreview:!1,showRemove:!1,showUpload:!1,browseLabel:"VÃ¤lj bild",browseIcon:""});$("input#image").on("change",function(){$("form.image-form").trigger("submit")}),$("button#modify-image").on("click",function(){$("div.image-cropper").removeClass("hidden"),$("div.card-create-forms").addClass("hidden");var e=$("img#image-cropper").data("Jcrop");e&&e.destroy(),setTimeout(function(){$("img#image-cropper").Jcrop({onChange:showPreview,onSelect:showPreview,aspectRatio:1}),$("img#image-cropper").css({width:"100%",height:"auto"})},500)}),$("form.image-form").on("submit",function(a){a.preventDefault();var i=new FormData($("form.image-form")[0]),s=$(this).attr("action"),r=$(this).attr("method"),t=$(this);$.ajax({url:s,type:r,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",progressHandlingFunction,!1),e},success:function(a){if(a.success)$("div.ajax-error").remove(),$("div.image-form-modify").removeClass("hidden"),$("img#image-cropper").attr("src","/uploads/"+a.url).show(),$("img#image-preview").attr("src","/uploads/"+a.url),$('input[name="image-url"]',"form.image-form-update").val(a.url),$('input[name="image"]',"form.form-user-create").val("/uploads/"+a.url);else{if($("div.ajax-error").length)$("div.ajax-error").html(a.message);else{var i='<div class="alert alert-danger ajax-error">'+a.message+"</div>";$(i).insertBefore(t)}e.fileinput("reset")}},error:function(){if($("div.ajax-error").length)$("div.ajax-error").html("Systemerror");else{var e='<div class="alert alert-danger ajax-error">Systemerror</div>';$(e).insertBefore(t)}},data:i,cache:!1,contentType:!1,processData:!1})}),$("li.nav-item-bump a").on("click",function(e){e.preventDefault(),$(this).parent().toggleClass("active"),$("div.bump-form").toggleClass("hidden",1e3)});var a=function(){var e=0;return""!=$('input[name="snapname"]').val()&&e++,""!=$('input[name="kik"]').val()&&e++,""!=$('input[name="instagram"]').val()&&e++,e};$('input[name="snapname"]').on("keyup",function(){var e=a();$("span.cards-item-name-text-update").text($(this).val()),$("ul.cards-item-usernames").removeClass("cards-item-usernames-1"),$("ul.cards-item-usernames").removeClass("cards-item-usernames-2"),$("ul.cards-item-usernames").removeClass("cards-item-usernames-3"),$("ul.cards-item-usernames").addClass("cards-item-usernames-"+e)}),$('input[name="kik"]').on("focusout",function(){var e=$(this).val();$.ajax({url:"/kik_image/",type:"post",data:{kik:e},dataType:"json",success:function(e){$("div.cards-item-image img#image-preview").attr("src",e.source)}})}),$('input[name="snapname"]').on("keyup",function(){var e=a(),i=$(".cards-item-usernames-snapchat"),s=$("ul.cards-item-usernames"),r=$(".cards-item-name-text-update");""==$('input[name="kik"]').val()&&r.text($(this).val()),""!=$(this).val()?(i.removeClass("hidden"),$(".cards-item-usernames-kik").removeClass("first"),isMobile.phone||i.css({height:i.width(),"line-height":i.width()+"px"})):i.addClass("hidden"),s.removeClass("cards-item-usernames-1"),s.removeClass("cards-item-usernames-2"),s.removeClass("cards-item-usernames-3"),s.addClass("cards-item-usernames-"+e)}),$('input[name="kik"]').on("keyup",function(){var e=a(),i=$(".cards-item-usernames-kik"),s=$("ul.cards-item-usernames"),r=$(".cards-item-name-text-update");""==$('input[name="snapname"]').val()&&(r.text($(this).val()),i.addClass("first")),""!=$(this).val()?(i.removeClass("hidden"),isMobile.phone||i.css({height:i.width(),"line-height":i.width()+"px"})):i.addClass("hidden"),s.removeClass("cards-item-usernames-1"),s.removeClass("cards-item-usernames-2"),s.removeClass("cards-item-usernames-3"),s.addClass("cards-item-usernames-"+e)}),$('input[name="instagram"]').on("keyup",function(){var e=a(),i=$(".cards-item-usernames-instagram"),s=$("ul.cards-item-usernames");""!=$('input[name="instagram"]').val()?(i.removeClass("hidden"),isMobile.phone||i.css({height:i.width(),"line-height":i.width()+"px"})):i.addClass("hidden"),s.removeClass("cards-item-usernames-1"),s.removeClass("cards-item-usernames-2"),s.removeClass("cards-item-usernames-3"),s.addClass("cards-item-usernames-"+e)}),$('input[name="age"]').on("keyup",function(){$("span.cards-item-name-age-text").text($(this).val())}),$('textarea[name="description"]').on("keyup",function(){$("div.cards-item-description p").text($(this).val())}),$('input[name="sex"]').on("change",function(){switch($("div.cards-item-name i.icon").removeClass("icon-transgender"),$(this).val()){case"1":$("div.cards-item-name i.icon").addClass("icon-boysymbol"),$("div.cards-item-name i.icon").removeClass("icon-girlsymbol");break;case"2":$("div.cards-item-name i.icon").addClass("icon-girlsymbol"),$("div.cards-item-name i.icon").removeClass("icon-boysymbol")}}),$("button.skip-crop").on("click",function(){$("div.image-cropper").addClass("hidden"),$("div.card-create-forms").removeClass("hidden"),$("div.image-form-modify").removeClass("hidden")}),$("form.image-form-update").on("submit",function(e){if(e.preventDefault(),0==$("div.jcrop-hline").width())return $("a.skip-crop").trigger("click"),!1;var a=$(this).serializeArray(),i=$(this).attr("action"),s=$(this).attr("method");$.ajax({url:i,type:s,success:function(){$("div.image-cropper").addClass("hidden"),$("div.card-create-forms").removeClass("hidden"),$("div.image-form-modify").addClass("hidden")},data:a})}),isMobile.phone||($("ul.cards-item-usernames li").each(function(){$(this).css({height:parseInt($(this).width())+parseInt($(this).css("padding-left"))+parseInt($(this).css("padding-right")),"line-height":parseInt($(this).width())+parseInt($(this).css("padding-left"))+parseInt($(this).css("padding-right"))+"px"})}),$(window).resize(function(){$("ul.cards-item-usernames li").each(function(){$(this).css({height:parseInt($(this).width())+parseInt($(this).css("padding-left"))+parseInt($(this).css("padding-right")),"line-height":parseInt($(this).width())+parseInt($(this).css("padding-left"))+parseInt($(this).css("padding-right"))+"px"})})}))});